# 目的

​	本文主要对Redis整个体系做了一个简单的介绍，主要是让大家对Redis体系有一个简单的认知。

# 前言

​	Redis，`Remote Dictionary Service`，即「远程字典服务」,是一款可基于内存也可持久化的日志型、Key-Value高性能Nosql数据库。Redis 以其超高的性能、丰富的数据类型、完美的文档、简洁易懂的源码和丰富的客户端库支持成为当前互联网技术领域使用最为广泛的存储中间件。

# 正文

## 超高的性能

​	正常情况下，Redis执行命令的速度非常快，官方给出的数字是读写性能高达10万/秒，当然这也取决于机器的性能，网络带宽等，那么Redis为什么这么快呢？归结到底主要有如下几点：

	1. Redis所有的数据都是存放在内存中，避免磁盘IO的消耗，这也是Redis具有超高性能的重要原因；
	2. Redis采用了单线程架构，避免了上下文切换的时间和性能消耗；
	3. 使用多路 I/O 复用模型；
## 多数据类型

​	Redis主要提供了五种数据结构，分别是string（字符串）、list（列表）、hash（哈希）、set（集合）、zset（有序集合），同时在字符串的基础上演变出了bitmaps（位图）和HyperLogLog这两种神奇的数据结构，另外Redis在3.2版本也引入了GEO（地理信息地位）的数据结构。

## 丰富的功能

​	Redis还为我们提供了许多额外的功能，主要有如下几点：

	1. 提供了键过期的功能，可以用于实现缓存；
	2. 提供了发布/订阅功能，可用于实现消息系统；
	3. 支持Lua脚本，可以自定命令；
	4. 提供了简单的事务功能，能在一定程度上保证了事务的特性；
	5. 提供了流水线（Pipeline）功能，这样客户端可以将一批命令一次性传到服务端，减少了网络开销；

## 支持持久化

​	通常来说，数据存放在内存中是有一定的风险的，因为这意味着一旦你的机器发生carsh，用户存放在内存中的数据就丢失，这对用户来说，显然是不可容忍的，好在Redis已有了较为完善的持久化机制，为其高可用性提供了保障。

​	Redis提供了RDB与AOF两种持久化方案，可以将内存中的数据保存到硬盘中。下面就简单的介绍这两种持久化策略。

1. **RDB持久化**

   RDB持久化是把当前进程数据生成快照保存到硬盘的过程，触发RDB持久化分为手动触发和主动触发。

2. **AOF持久化**

   AOF持久化是以独立日志命令的方式记录每次Redis写入命令，重启时在重新执行AOF文件中的命令达到恢复数据的目的。AOF持久化主要是解决了数据持久化的实时性，目前已经成为Redis持久化的主流方式。

## 主从复制、高可用和分布式

​	Redis提供了主从复制功能，实现了多个相同数据的Redis副本，Redis主从复制也是Redis高可用和分布式的基础。

​	Redis在2.8版本推出了Redis Sentinel（Redis哨兵），它能够保障Redis节点的故障发现和故障自动转移，也是Redis高可用的实现方案。

​	Redis在3.0版本正式提供了分布式实现Redis Cluster，它是Redis真正的分布式实现，提供了高可用、读写、和容量的扩展性。

## Redis常见使用场景

​	在学习一门新的技术时，我们不仅要掌握其实现原理，更要了解所学的技术到底可以用来做什么。下面主要介绍了Redis在实际应用中的几种使用场景。

1. **使用Redis作为缓存中间件**

   ​	Redis提供了键过期的功能，所以常被用于缓存。

   ​	在互联网web应用中，合理的使用缓存可以有效的加速应用的响应速度，降低后端的负载压力。这里要注意合理这两字，因为缓存也不是万金油，使用起来也是一门高深学问，这里包含了冷热数据，数据一致性，缓存穿透，雪崩等等问题，此处不做深入讨论。


2. **使用Redis异步消息队列**

   ​	Redis提供的list（列表）数据结构，常用于做异步消息队列。使用`rpush/lpush`操作入队列，使用`lpop 和 rpop`来出队列。还有一种是使用`blpop`和`	brpop`这两个阻塞命令来做阻塞队列的实现方案，但要注意的是这种方案实现的是1:1的队列；

   ​	Redis也提供了pub/sub主题订阅者模式，为我们实现了1：N的消息队列。

3. **使用Redis打造分布式锁**

   ​	Redis提供了`set key value [ex seconds][px milliseconds] [nx|xx]`指令，常用于做分布式锁的实现方案。`set key value [ex seconds] [nx]`标识只有key不存在的时候才会执行插入，且这个key具有一定的过期时间。